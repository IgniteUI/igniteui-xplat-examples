trigger:
  branches:
    include:
    - vnext
  paths:
    include:
      - 'samples/**/*.json'
    exclude:
      - 'master'

parameters:
  - name: pathsToParse
    displayName: 'Full paths that contain jsons - coma delimited'
    type: string
    default: '$(Pipeline.Workspace)\igniteui-xplat-examples\samples\charts\sparkline'

pr:
  branches:
    include:
    - 'vnext'  # must quote since "*" is a YAML reserved character; we want a string
    - 'azure-pipeline-use-code-exporter-app'
    exclude:
      - 'master'

name: $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)
variables:
  - name: codeExporterAppBranch
    value: '2022.2'

resources:
  repositories:
# [MTrela 18/04/2023] Exclude exporting this repo to IgniteUIAngularExamples because our Angular template is not complete  
#    - repository: IgniteUIAngularExamples
#      endpoint: IgniteUI
#      type: github
#      name: IgniteUI/igniteui-angular-examples
#      ref: '$(Build.SourceBranch)'

    - repository: IgniteUIBlazorExamples
      endpoint: IgniteUI
      type: github
      name: IgniteUI/igniteui-blazor-examples
      ref: '$(Build.SourceBranch)'
      #ref: 'vnext'

    - repository: IgniteUIReactExamples
      endpoint: IgniteUI
      type: github
      name: IgniteUI/igniteui-react-examples
      ref: '$(Build.SourceBranch)'
      #ref: 'vnext'

    - repository: IgniteUIWebComponentsExamples
      endpoint: IgniteUI
      type: github
      name: IgniteUI/igniteui-wc-examples
      ref: '$(Build.SourceBranch)'
      #ref: 'vnext'

    - repository: IgEditorTemplates
      type: git
      name: igeditor-templates
      ref: 'master'

    - repository: CodeGenerationLibrary
      type: git
      name: code-generation-library
      ref: '2022.2'

    - repository: CodeGenerationLibrary
      type: git
      name: code-generation-library
      ref: '2022.2'

pool:
  name: BuildAgentOnPrem

jobs:
# [MTrela 18/04/2023] Exclude exporting this repo to IgniteUIAngularExamples because our Angular template is not complete    
#  - template: templates/convert-to-platform-job.yml
#    parameters:
#      platform: 'Angular'
#      destinationGitRepo: 'igniteui-angular-examples'
#      pathsToParse: ${{ parameters.pathsToParse }}
#      codeExporterAppBranch: $(codeExporterAppBranch)

- template: templates/convert-to-platform-job.yml
  parameters:
    platform: 'Blazor'
    destinationGitRepo: 'igniteui-blazor-examples'
    pathsToParse: ${{ parameters.pathsToParse }}
    codeExporterAppBranch: $(codeExporterAppBranch)
    createPR: true

- template: templates/convert-to-platform-job.yml
  parameters:
    platform: 'React'
    destinationGitRepo: 'igniteui-react-examples'
    pathsToParse: ${{ parameters.pathsToParse }}
    codeExporterAppBranch: $(codeExporterAppBranch)
    createPR: true

- template: templates/convert-to-platform-job.yml
  parameters:
    platform: 'WebComponents'
    destinationGitRepo: 'igniteui-wc-examples'
    pathsToParse: ${{ parameters.pathsToParse }}
    codeExporterAppBranch: $(codeExporterAppBranch)
    createPR: true
